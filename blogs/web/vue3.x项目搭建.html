<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue3.x项目工程搭建 | jun的个人空间</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/blog/favicon.ico">
    <meta name="description" content="A simple and beautiful vuepress blog theme .">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/blog/assets/css/0.styles.22e22db1.css" as="style"><link rel="preload" href="/blog/assets/js/app.2e9aaf02.js" as="script"><link rel="preload" href="/blog/assets/js/3.df7e12f5.js" as="script"><link rel="preload" href="/blog/assets/js/1.71a2a4d1.js" as="script"><link rel="preload" href="/blog/assets/js/29.f03180e4.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.06cfad2a.js"><link rel="prefetch" href="/blog/assets/js/11.df88bce0.js"><link rel="prefetch" href="/blog/assets/js/12.041115a7.js"><link rel="prefetch" href="/blog/assets/js/13.f0185e2a.js"><link rel="prefetch" href="/blog/assets/js/14.5a045b81.js"><link rel="prefetch" href="/blog/assets/js/15.7164e1d7.js"><link rel="prefetch" href="/blog/assets/js/16.f9c02261.js"><link rel="prefetch" href="/blog/assets/js/17.d889275f.js"><link rel="prefetch" href="/blog/assets/js/18.11d93686.js"><link rel="prefetch" href="/blog/assets/js/19.c7295ef8.js"><link rel="prefetch" href="/blog/assets/js/20.ef0bf1ef.js"><link rel="prefetch" href="/blog/assets/js/21.c0808f41.js"><link rel="prefetch" href="/blog/assets/js/22.411bd3f9.js"><link rel="prefetch" href="/blog/assets/js/23.18a8e710.js"><link rel="prefetch" href="/blog/assets/js/24.ca6e4b20.js"><link rel="prefetch" href="/blog/assets/js/25.0d72f462.js"><link rel="prefetch" href="/blog/assets/js/26.c4c011ae.js"><link rel="prefetch" href="/blog/assets/js/27.eb3de618.js"><link rel="prefetch" href="/blog/assets/js/28.f8e2a1e2.js"><link rel="prefetch" href="/blog/assets/js/30.36ab1f30.js"><link rel="prefetch" href="/blog/assets/js/31.eeacc110.js"><link rel="prefetch" href="/blog/assets/js/32.20a67723.js"><link rel="prefetch" href="/blog/assets/js/33.eedb8eae.js"><link rel="prefetch" href="/blog/assets/js/34.5746a48f.js"><link rel="prefetch" href="/blog/assets/js/35.5aae019c.js"><link rel="prefetch" href="/blog/assets/js/36.8cf983a3.js"><link rel="prefetch" href="/blog/assets/js/37.52c37ca6.js"><link rel="prefetch" href="/blog/assets/js/38.a2ae90d0.js"><link rel="prefetch" href="/blog/assets/js/39.491dc017.js"><link rel="prefetch" href="/blog/assets/js/4.868230a6.js"><link rel="prefetch" href="/blog/assets/js/40.aa1410cd.js"><link rel="prefetch" href="/blog/assets/js/5.ea5f743c.js"><link rel="prefetch" href="/blog/assets/js/6.c6d16241.js"><link rel="prefetch" href="/blog/assets/js/7.e9233ad5.js"><link rel="prefetch" href="/blog/assets/js/8.7ae95209.js"><link rel="prefetch" href="/blog/assets/js/9.3304f7f8.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.22e22db1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-945f89ac><div data-v-945f89ac><div id="loader-wrapper" class="loading-wrapper" data-v-2c578df8 data-v-945f89ac data-v-945f89ac><div class="loader-main" data-v-2c578df8><div data-v-2c578df8></div><div data-v-2c578df8></div><div data-v-2c578df8></div><div data-v-2c578df8></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-3dc17307 data-v-945f89ac data-v-945f89ac><h3 class="title" style="display:none;" data-v-3dc17307 data-v-3dc17307>jun的个人空间</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-3dc17307 data-v-3dc17307><input type="password" value="" data-v-3dc17307> <span data-v-3dc17307>Konck! Knock!</span> <button data-v-3dc17307>OK</button></label> <div class="footer" style="display:none;" data-v-3dc17307 data-v-3dc17307><span data-v-3dc17307><i class="iconfont reco-theme" data-v-3dc17307></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-3dc17307>vuePress-theme-reco</a></span> <span data-v-3dc17307><i class="iconfont reco-copyright" data-v-3dc17307></i> <a data-v-3dc17307><span data-v-3dc17307>jun</span>
            
          <span data-v-3dc17307>2017 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-945f89ac><header class="navbar" data-v-945f89ac><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/logo.png" alt="jun的个人空间" class="logo"> <span class="site-name">jun的个人空间</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/系统教程/" class="nav-link"><i class="iconfont undefined"></i>
  系统教程
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/环境构建/" class="nav-link"><i class="iconfont undefined"></i>
  环境构建
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/K8S/" class="nav-link"><i class="iconfont undefined"></i>
  K8S
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/前端/" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/工具/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/性能优化/" class="nav-link"><i class="iconfont undefined"></i>
  性能优化
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      文档
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/docs/theme-reco/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-945f89ac></div> <aside class="sidebar" data-v-945f89ac><div class="personal-info-wrapper" data-v-661bee24><img src="/blog/avatar.jpg" alt="author-avatar" class="personal-img" data-v-661bee24> <h3 class="name" data-v-661bee24>
    jun
  </h3> <div class="num" data-v-661bee24><div data-v-661bee24><h3 data-v-661bee24>26</h3> <h6 data-v-661bee24>文章</h6></div> <div data-v-661bee24><h3 data-v-661bee24>31</h3> <h6 data-v-661bee24>标签</h6></div></div> <hr data-v-661bee24></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/系统教程/" class="nav-link"><i class="iconfont undefined"></i>
  系统教程
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/环境构建/" class="nav-link"><i class="iconfont undefined"></i>
  环境构建
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/K8S/" class="nav-link"><i class="iconfont undefined"></i>
  K8S
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/前端/" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/工具/" class="nav-link"><i class="iconfont undefined"></i>
  工具
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/性能优化/" class="nav-link"><i class="iconfont undefined"></i>
  性能优化
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      文档
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/docs/theme-reco/" class="nav-link"><i class="iconfont undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue3.x项目工程搭建</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#技术栈" class="sidebar-link">技术栈</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#架构搭建" class="sidebar-link">架构搭建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#使用-vite-快速初始化项目雏形" class="sidebar-link">使用 Vite 快速初始化项目雏形</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#修改-vite-配置文件" class="sidebar-link">修改 Vite 配置文件</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#规范目录结构" class="sidebar-link">规范目录结构</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成路由工具-vue-router" class="sidebar-link">集成路由工具 Vue Router</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成状态管理工具-vuex" class="sidebar-link">集成状态管理工具 Vuex</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-ui-框架-element-plus" class="sidebar-link">集成 UI 框架 Element Plus</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-http-工具-axios" class="sidebar-link">集成 HTTP 工具 Axios</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-css-预编译器-stylus-sass-less" class="sidebar-link">集成 CSS 预编译器 Stylus/Sass/Less</a></li></ul></li><li><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#代码规范" class="sidebar-link">代码规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-editorconfig-配置" class="sidebar-link">集成 EditorConfig 配置</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-prettier-配置" class="sidebar-link">集成 Prettier 配置</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-eslint-配置" class="sidebar-link">集成 ESLint 配置</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#解决-prettier-和-eslint-的冲突" class="sidebar-link">解决 Prettier 和 ESLint 的冲突</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-husky-和-lint-staged" class="sidebar-link">集成 husky 和 lint-staged</a></li></ul></li><li><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#提交规范" class="sidebar-link">提交规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#commit-message-格式规范" class="sidebar-link">commit message 格式规范</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-commitizen-实现规范提交" class="sidebar-link">集成 Commitizen 实现规范提交</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-commitlint-验证提交规范" class="sidebar-link">集成 commitlint 验证提交规范</a></li></ul></li><li><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#单元测试" class="sidebar-link">单元测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#安装核心依赖" class="sidebar-link">安装核心依赖</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#创建-jest-配置文件" class="sidebar-link">创建 jest 配置文件</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#创建单元测试文件" class="sidebar-link">创建单元测试文件</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#集成-types-jest" class="sidebar-link">集成 @types/jest</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#添加-eslint-plugin-jest" class="sidebar-link">添加 eslint-plugin-jest</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#执行单元测试" class="sidebar-link">执行单元测试</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#单元测试约束" class="sidebar-link">单元测试约束</a></li></ul></li><li><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#自动部署" class="sidebar-link">自动部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#什么是-github-actions" class="sidebar-link">什么是 GitHub Actions</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#配置-github-actions" class="sidebar-link">配置 GitHub Actions</a></li><li class="sidebar-sub-header"><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#自动部署触发原理" class="sidebar-link">自动部署触发原理</a></li></ul></li><li><a href="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html#最后" class="sidebar-link">最后</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-3dc17307 data-v-945f89ac><h3 class="title" style="display:none;" data-v-3dc17307 data-v-3dc17307>Vue3.x项目工程搭建</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-3dc17307 data-v-3dc17307><input type="password" value="" data-v-3dc17307> <span data-v-3dc17307>Konck! Knock!</span> <button data-v-3dc17307>OK</button></label> <div class="footer" style="display:none;" data-v-3dc17307 data-v-3dc17307><span data-v-3dc17307><i class="iconfont reco-theme" data-v-3dc17307></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-3dc17307>vuePress-theme-reco</a></span> <span data-v-3dc17307><i class="iconfont reco-copyright" data-v-3dc17307></i> <a data-v-3dc17307><span data-v-3dc17307>jun</span>
            
          <span data-v-3dc17307>2017 - </span>
          2021
        </a></span></div></div> <div data-v-945f89ac><main class="page"><div class="page-title" style="display:none;"><h1>Vue3.x项目工程搭建</h1> <hr> <div data-v-32e7eb69><i class="iconfont reco-account" data-v-32e7eb69><span data-v-32e7eb69>jun</span></i> <i class="iconfont reco-date" data-v-32e7eb69><span data-v-32e7eb69>2021-07-30 08:11:25</span></i> <i class="iconfont reco-eye" data-v-32e7eb69><span id="/blog/blogs/web/vue3.x%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-32e7eb69><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-32e7eb69><span class="tag-item" data-v-32e7eb69>vue3</span><span class="tag-item" data-v-32e7eb69>TS</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><p>Vue3 跟 Vite 正式版发布有很长一段时间了，生态圈也渐渐丰富起来，作者已在多个项目中使用，总结一下：就是快！也不用担心稳定性问题，开发体验真不是一般好！还没尝试的同学可以从本文开始学习，从 0 开始手把手带你搭建一套规范的 Vite + Vue3 + TypeScript 前端工程化项目环境。</p> <p>本文篇幅较长，从以下几个方面展开：</p> <ul><li>架构搭建</li> <li>代码规范</li> <li>提交规范</li> <li>单元测试</li> <li>自动部署</li></ul> <h2 id="技术栈"><a href="#技术栈" class="header-anchor">#</a> 技术栈</h2> <ul><li>编程语言：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.typescriptlang.org%2Fzh%2F" title="https://www.typescriptlang.org/zh/" target="_blank" rel="noopener noreferrer">TypeScript 4.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.javascript.com%2F" title="https://www.javascript.com/" target="_blank" rel="noopener noreferrer">JavaScript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>构建工具：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fcn.vitejs.dev%2F" title="https://cn.vitejs.dev/" target="_blank" rel="noopener noreferrer">Vite 2.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>前端框架：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fv3.cn.vuejs.org%2F" title="https://v3.cn.vuejs.org/" target="_blank" rel="noopener noreferrer">Vue 3.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>路由工具：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fnext.router.vuejs.org%2Fzh%2Findex.html" title="https://next.router.vuejs.org/zh/index.html" target="_blank" rel="noopener noreferrer">Vue Router 4.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>状态管理：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fnext.vuex.vuejs.org%2F" title="https://next.vuex.vuejs.org/" target="_blank" rel="noopener noreferrer">Vuex 4.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>UI 框架：<a href="https://link.juejin.cn/?target=https%3A%2F%2Felement-plus.org%2F%23%2Fzh-CN" title="https://element-plus.org/#/zh-CN" target="_blank" rel="noopener noreferrer">Element Plus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>CSS 预编译：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fstylus-lang.com%2F" title="https://stylus-lang.com/" target="_blank" rel="noopener noreferrer">Stylus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> / <a href="https://link.juejin.cn/?target=https%3A%2F%2Fsass.bootcss.com%2Fdocumentation" title="https://sass.bootcss.com/documentation" target="_blank" rel="noopener noreferrer">Sass<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> / <a href="https://link.juejin.cn/?target=http%3A%2F%2Flesscss.cn%2F" title="http://lesscss.cn/" target="_blank" rel="noopener noreferrer">Less<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>HTTP 工具：<a href="https://link.juejin.cn/?target=https%3A%2F%2Faxios-http.com%2F" title="https://axios-http.com/" target="_blank" rel="noopener noreferrer">Axios<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Git Hook 工具：<a href="https://link.juejin.cn/?target=https%3A%2F%2Ftypicode.github.io%2Fhusky%2F%23%2F" title="https://typicode.github.io/husky/#/" target="_blank" rel="noopener noreferrer">husky<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fokonet%2Flint-staged" title="https://github.com/okonet/lint-staged" target="_blank" rel="noopener noreferrer">lint-staged<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>代码规范：<a href="https://link.juejin.cn/?target=http%3A%2F%2Feditorconfig.org" title="http://editorconfig.org" target="_blank" rel="noopener noreferrer">EditorConfig<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fprettier.io%2F" title="https://prettier.io/" target="_blank" rel="noopener noreferrer">Prettier<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Feslint.org%2F" title="https://eslint.org/" target="_blank" rel="noopener noreferrer">ESLint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fairbnb%2Fjavascript%23translation" title="https://github.com/airbnb/javascript#translation" target="_blank" rel="noopener noreferrer">Airbnb JavaScript Style Guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>提交规范：<a href="https://link.juejin.cn/?target=http%3A%2F%2Fcommitizen.github.io%2Fcz-cli%2F" title="http://commitizen.github.io/cz-cli/" target="_blank" rel="noopener noreferrer">Commitizen<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fcommitlint.js.org%2F%23%2F" title="https://commitlint.js.org/#/" target="_blank" rel="noopener noreferrer">Commitlint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>单元测试：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fnext.vue-test-utils.vuejs.org%2F" title="https://next.vue-test-utils.vuejs.org/" target="_blank" rel="noopener noreferrer">vue-test-utils<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fjestjs.io%2F" title="https://jestjs.io/" target="_blank" rel="noopener noreferrer">jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fvue-jest" title="https://github.com/vuejs/vue-jest" target="_blank" rel="noopener noreferrer">vue-jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fkulshekhar.github.io%2Fts-jest%2F" title="https://kulshekhar.github.io/ts-jest/" target="_blank" rel="noopener noreferrer">ts-jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>自动部署：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdocs.github.com%2Fcn%2Factions%2Flearn-github-actions" title="https://docs.github.com/cn/actions/learn-github-actions" target="_blank" rel="noopener noreferrer">GitHub Actions<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="架构搭建"><a href="#架构搭建" class="header-anchor">#</a> 架构搭建</h2> <p>请确保你的电脑上成功安装 Node.js，本项目使用 Vite 构建工具，<strong>需要 Node.js 版本 &gt;= 12.0.0</strong>。</p> <p>查看 Node.js 版本：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>node -v

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>建议将 Node.js 升级到最新的稳定版本：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 使用 nvm 安装最新稳定版 Node.js</span>
nvm <span class="token function">install</span> stable

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="使用-vite-快速初始化项目雏形"><a href="#使用-vite-快速初始化项目雏形" class="header-anchor">#</a> 使用 Vite 快速初始化项目雏形</h3> <ul><li><p>使用 NPM：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> init @vitejs/app

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>使用 Yarn：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">yarn</span> create @vitejs/app

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p>然后按照终端提示完成以下操作：</p> <ol><li><p>输入项目名称</p> <p>例如：本项目名称 <strong>vite-vue3-starter</strong></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/959dc45b86ca4066a1bcece8de88dc8d~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>选择模板</p> <p>本项目需要使用 Vue3 + TypeScript，所以我们选择 <code>vue-ts</code>，会自动安装 Vue3 和 TypeScript。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/176e9cfb0f4545fc8d6ff8b5eb9422a2~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7126a1dc802d411ab375289ac827b71e~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>你还可以通过附加的命令行选项直接指定项目名和模板，本项目要构建 Vite + Vue3 + TypeScript 项目，则运行：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># npm 6.x</span>
<span class="token function">npm</span> init @vitejs/app vite-vue3-starter --template vue-ts

<span class="token comment"># npm 7+（需要额外的双横线）</span>
<span class="token function">npm</span> init @vitejs/app vite-vue3-starter -- --template vue-ts

<span class="token comment"># yarn</span>
<span class="token function">yarn</span> create @vitejs/app vite-vue3-starter --template vue-ts

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>安装依赖</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>启动项目</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> run dev

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3afd23c1469a45e895bb488eac45adfe~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>如上图，表示 Vite + Vue3 + TypeScript 简单的项目骨架搭建完毕，下面我们来为这个项目集成 Vue Router、Vuex、Element Plus、Axios、Stylus/Sass/Less。</p></li></ol> <h3 id="修改-vite-配置文件"><a href="#修改-vite-配置文件" class="header-anchor">#</a> 修改 Vite 配置文件</h3> <p>Vite 配置文件 <code>vite.config.ts</code> 位于根目录下，项目启动时会自动读取。</p> <p>本项目先做一些简单配置，例如：设置 <code>@</code> 指向 <code>src</code> 目录、 服务启动端口、打包路径、代理等。</p> <p>关于 Vite 更多配置项及用法，请查看 Vite 官网 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fvitejs.dev%2Fconfig%2F" title="https://vitejs.dev/config/" target="_blank" rel="noopener noreferrer">vitejs.dev/config/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 。</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vite'</span>
<span class="token keyword">import</span> vue <span class="token keyword">from</span> <span class="token string">'@vitejs/plugin-vue'</span>
<span class="token comment">// 如果编辑器提示 path 模块找不到，则可以安装一下 @types/node -&gt; npm i @types/node -D</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> resolve <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'path'</span>

<span class="token comment">// https://vitejs.dev/config/</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">vue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    alias<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'@'</span><span class="token operator">:</span> <span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span> <span class="token comment">// 设置 `@` 指向 `src` 目录</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  base<span class="token operator">:</span> <span class="token string">'./'</span><span class="token punctuation">,</span> <span class="token comment">// 设置打包路径</span>
  server<span class="token operator">:</span> <span class="token punctuation">{</span>
    port<span class="token operator">:</span> <span class="token number">4000</span><span class="token punctuation">,</span> <span class="token comment">// 设置服务启动端口号</span>
    open<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 设置服务启动时是否自动打开浏览器</span>
    cors<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 允许跨域</span>

    <span class="token comment">// 设置代理，根据我们项目实际情况配置</span>
    <span class="token comment">// proxy: {</span>
    <span class="token comment">//   '/api': {</span>
    <span class="token comment">//     target: 'http://xxx.xxx.xxx.xxx:8000',</span>
    <span class="token comment">//     changeOrigin: true,</span>
    <span class="token comment">//     secure: false,</span>
    <span class="token comment">//     rewrite: (path) =&gt; path.replace('/api/', '/')</span>
    <span class="token comment">//   }</span>
    <span class="token comment">// }</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="规范目录结构"><a href="#规范目录结构" class="header-anchor">#</a> 规范目录结构</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── publish/
└── src/
    ├── assets/                    // 静态资源目录
    ├── common/                    // 通用类库目录
    ├── components/                // 公共组件目录
    ├── router/                    // 路由配置目录
    ├── store/                     // 状态管理目录
    ├── style/                     // 通用 CSS 目录
    ├── utils/                     // 工具函数目录
    ├── views/                     // 页面组件目录
    ├── App.vue
    ├── main.ts
    ├── shims-vue.d.ts
├── tests/                         // 单元测试目录
├── index.html
├── tsconfig.json                  // TypeScript 配置文件
├── vite.config.ts                 // Vite 配置文件
└── package.json

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="集成路由工具-vue-router"><a href="#集成路由工具-vue-router" class="header-anchor">#</a> 集成路由工具 Vue Router</h3> <ol><li><p>安装支持 Vue3 的路由工具 vue-router@4</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i vue-router@4

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>创建 <code>src/router/index.ts</code> 文件</p> <p>在 <code>src</code> 下创建 <code>router</code> 目录，然后在 <code>router</code> 目录里新建 <code>index.ts</code> 文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> └── src/
     ├── router/
         ├── index.ts  // 路由配置文件

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  createRouter<span class="token punctuation">,</span>
  createWebHashHistory<span class="token punctuation">,</span>
  RouteRecordRaw
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">import</span> Home <span class="token keyword">from</span> <span class="token string">'@/views/home.vue'</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">'@/views/vuex.vue'</span>

<span class="token keyword">const</span> routes<span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>RouteRecordRaw<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'Home'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/vuex'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'Vuex'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Vuex
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/axios'</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'Axios'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'@/views/axios.vue'</span><span class="token punctuation">)</span> <span class="token comment">// 懒加载组件</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>根据本项目路由配置的实际情况，你需要在 <code>src</code> 下创建 <code>views</code> 目录，用来存储页面组件。</p> <p>我们在 <code>views</code> 目录下创建 <code>home.vue</code> 、<code>vuex.vue</code> 、<code>axios.vue</code>。</p></li> <li><p>在 <code>main.ts</code> 文件中挂载路由配置</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router/index'</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ol> <h3 id="集成状态管理工具-vuex"><a href="#集成状态管理工具-vuex" class="header-anchor">#</a> 集成状态管理工具 Vuex</h3> <ol><li><p>安装支持 Vue3 的状态管理工具 vuex@next</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i vuex@next

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>创建 <code>src/store/index.ts</code> 文件</p> <p>在 <code>src</code> 下创建 <code>store</code> 目录，然后在 <code>store</code> 目录里新建 <code>index.ts</code> 文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>└── src/
    ├── store/
        ├── index.ts  // store 配置文件

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
  count<span class="token operator">:</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token comment">// Create a new store instance.</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> defaultState
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token keyword">typeof</span> defaultState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>count<span class="token operator">++</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">increment</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increment'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">double</span><span class="token punctuation">(</span>state<span class="token operator">:</span> <span class="token keyword">typeof</span> defaultState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">2</span> <span class="token operator">*</span> state<span class="token punctuation">.</span>count
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div></li> <li><p>在 <code>main.ts</code> 文件中挂载 Vuex 配置</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store/index'</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ol> <h3 id="集成-ui-框架-element-plus"><a href="#集成-ui-框架-element-plus" class="header-anchor">#</a> 集成 UI 框架 Element Plus</h3> <ol><li><p>安装支持 Vue3 的 UI 框架 Element Plus</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i element-plus

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>在 <code>main.ts</code> 文件中挂载 Element Plus</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>

<span class="token keyword">import</span> ElementPlus <span class="token keyword">from</span> <span class="token string">'element-plus'</span>
<span class="token keyword">import</span> <span class="token string">'element-plus/lib/theme-chalk/index.css'</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementPlus<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ol> <h3 id="集成-http-工具-axios"><a href="#集成-http-工具-axios" class="header-anchor">#</a> 集成 HTTP 工具 Axios</h3> <ol><li><p>安装 Axios（Axios 跟 Vue 版本没有直接关系，安装最新即可）</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i axios

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>配置 Axios</p> <blockquote><p>为了使项目的目录结构合理且规范，我们在 <code>src</code> 下创建 <code>utils</code> 目录来存储我们常用的工具函数。</p></blockquote> <p>Axios 作为 HTTP 工具，我们在 <code>utils</code> 目录下创建 <code>axios.ts</code> 作为 Axios 配置文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>└── src/
    ├── utils/
        ├── axios.ts  // Axios 配置文件

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> Axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ElMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-plus'</span>

<span class="token keyword">const</span> baseURL <span class="token operator">=</span> <span class="token string">'https://api.github.com'</span>

<span class="token keyword">const</span> axios <span class="token operator">=</span> Axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  baseURL<span class="token punctuation">,</span>
  timeout<span class="token operator">:</span> <span class="token number">20000</span> <span class="token comment">// 请求超时 20s</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 前置拦截器（发起请求之前的拦截）</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 根据你的项目实际情况来对 config 做处理
     * 这里对 config 不做任何处理，直接返回
     */</span>
    <span class="token keyword">return</span> response
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token comment">// 后置拦截器（获取到响应时的拦截）</span>
axios<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">/**
     * 根据你的项目实际情况来对 response 和 error 做处理
     * 这里对 response 和 error 不做任何处理，直接返回
     */</span>
    <span class="token keyword">return</span> response
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response <span class="token operator">&amp;&amp;</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> code <span class="token operator">=</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>status
      <span class="token keyword">const</span> msg <span class="token operator">=</span> error<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>message
      ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Code: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>code<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, Message: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[Axios Error]</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>response<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      ElMessage<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> axios

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div></li> <li><p>使用 Axios<br>
在需要使用 Axios 文件里，引入 Axios 配置文件，参考如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
  <span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'../utils/axios'</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      axios
        <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/users/XPoet'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res: '</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'err: '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li></ol> <h3 id="集成-css-预编译器-stylus-sass-less"><a href="#集成-css-预编译器-stylus-sass-less" class="header-anchor">#</a> 集成 CSS 预编译器 Stylus/Sass/Less</h3> <p>本项目使用 CSS 预编译器 Stylus，直接安装为开发依赖即可。Vite 内部已帮我们集成了相关的 loader，不需要额外配置。同理，你也可以使用 Sass 或 Less 等。</p> <ol><li><p>安装</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i stylus -D
<span class="token comment"># or</span>
<span class="token function">npm</span> i sass -D
<span class="token function">npm</span> i <span class="token function">less</span> -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>使用</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylus<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  ...
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ol> <p>至此，一个基于 TypeScript + Vite + Vue3 + Vue Router + Vuex + Element Plus + Axios + Stylus/Sass/Less 的前端项目开发环境搭建完毕，项目 Demo 托管在 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FXPoet%2Fvite-vue3-starter" title="https://github.com/XPoet/vite-vue3-starter" target="_blank" rel="noopener noreferrer">GitHub 仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，需要的同学可以去下载下来，参考学习。</p> <p>下面我们来打磨这个项目，增加代码规范约束、提交规范约束、单元测试、自动部署等，让其更完善、更健壮。</p> <h2 id="代码规范"><a href="#代码规范" class="header-anchor">#</a> 代码规范</h2> <p>随着前端应用逐渐变得大型化和复杂化，在同一个项目中有多个人员参与时，每个人的前端能力程度不等，他们往往会用不同的编码风格和习惯在项目中写代码，长此下去，势必会让项目的健壮性越来越差。解决这些问题，理论上讲，口头约定和代码审查都可以，但是这种方式无法实时反馈，而且沟通成本过高，不够灵活，更关键的是无法把控。不以规矩，不能成方圆，我们不得不在项目使用一些工具来约束代码规范。</p> <p>本文讲解如何使用 <strong>EditorConfig + Prettier + ESLint</strong> 组合来实现代码规范化。</p> <p>这样做带来好处：</p> <ul><li>解决团队之间代码不规范导致的可读性差和可维护性差的问题。</li> <li>解决团队成员不同编辑器导致的编码规范不统一问题。</li> <li>提前发现代码风格问题，给出对应规范提示，及时修复。</li> <li>减少代码审查过程中反反复复的修改过程，节约时间。</li> <li>自动格式化，统一编码风格，从此和脏乱差的代码说再见。</li></ul> <h3 id="集成-editorconfig-配置"><a href="#集成-editorconfig-配置" class="header-anchor">#</a> 集成 EditorConfig 配置</h3> <p>EditorConfig 有助于为不同 IDE 编辑器上处理同一项目的多个开发人员维护一致的编码风格。</p> <p>官网：<a href="https://link.juejin.cn/?target=http%3A%2F%2Feditorconfig.org" title="http://editorconfig.org" target="_blank" rel="noopener noreferrer">editorconfig.org<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>在项目根目录下增加 <code>.editorconfig</code> 文件：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># Editor configuration, see http://editorconfig.org</span>

<span class="token comment"># 表示是最顶层的 EditorConfig 配置文件</span>
root <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token comment"># 表示所有文件适用</span>
charset <span class="token operator">=</span> utf-8 <span class="token comment"># 设置文件字符集为 utf-8</span>
indent_style <span class="token operator">=</span> space <span class="token comment"># 缩进风格（tab | space）</span>
indent_size <span class="token operator">=</span> <span class="token number">2</span> <span class="token comment"># 缩进大小</span>
end_of_line <span class="token operator">=</span> lf <span class="token comment"># 控制换行类型(lf | cr | crlf)</span>
trim_trailing_whitespace <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment"># 去除行首的任意空白字符</span>
insert_final_newline <span class="token operator">=</span> <span class="token boolean">true</span> <span class="token comment"># 始终在文件末尾插入一个新行</span>

<span class="token punctuation">[</span>*.md<span class="token punctuation">]</span> <span class="token comment"># 表示仅 md 文件适用以下规则</span>
max_line_length <span class="token operator">=</span> off
trim_trailing_whitespace <span class="token operator">=</span> <span class="token boolean">false</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>注意：</p> <ul><li><p>VSCode 使用 EditorConfig 需要去插件市场下载插件 <strong>EditorConfig for VS Code</strong> 。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/51ca554c3b01470397de87ef0a92481d~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>JetBrains 系列（WebStorm、IntelliJ IDEA 等）则不用额外安装插件，可直接使用 EditorConfig 配置。</p></li></ul> <h3 id="集成-prettier-配置"><a href="#集成-prettier-配置" class="header-anchor">#</a> 集成 Prettier 配置</h3> <p>Prettier 是一款强大的代码格式化工具，支持 JavaScript、TypeScript、CSS、SCSS、Less、JSX、Angular、Vue、GraphQL、JSON、Markdown 等语言，基本上前端能用到的文件格式它都可以搞定，是当下最流行的代码格式化工具。</p> <p>官网：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fprettier.io%2F" title="https://prettier.io/" target="_blank" rel="noopener noreferrer">prettier.io/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ol><li><p>安装 Prettier</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i prettier -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>创建 Prettier 配置文件</p> <p>Prettier 支持多种格式的<a href="https://link.juejin.cn/?target=https%3A%2F%2Fprettier.io%2Fdocs%2Fen%2Fconfiguration.html" title="https://prettier.io/docs/en/configuration.html" target="_blank" rel="noopener noreferrer">配置文件<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，比如 <code>.json</code>、<code>.yml</code>、<code>.yaml</code>、<code>.js</code>等。</p> <p>在本项目根目录下创建 <code>.prettierrc</code> 文件。</p></li> <li><p>配置 <code>.prettierrc</code></p> <p>在本项目中，我们进行如下简单配置，关于更多配置项信息，请前往官网查看 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fprettier.io%2Fdocs%2Fen%2Foptions.html" title="https://prettier.io/docs/en/options.html" target="_blank" rel="noopener noreferrer">Prettier-Options<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 。</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;useTabs&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tabWidth&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;printWidth&quot;</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
  <span class="token property">&quot;singleQuote&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;trailingComma&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;bracketSpacing&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;semi&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>Prettier 安装且配置好之后，就能使用命令来格式化代码</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 格式化所有文件（. 表示所有文件）</span>
npx prettier --write <span class="token builtin class-name">.</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ol> <p>注意：</p> <ul><li><p>VSCode 编辑器使用 Prettier 配置需要下载插件 <strong>Prettier - Code formatter</strong> 。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba1f48fbd3bf441b90d58012270c867b~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>JetBrains 系列编辑器（WebStorm、IntelliJ IDEA 等）则不用额外安装插件，可直接使用 Prettier 配置。</p></li></ul> <p>Prettier 配置好以后，在使用 VSCode 或 WebStorm 等编辑器的格式化功能时，编辑器就会按照 Prettier 配置文件的规则来进行格式化，避免了因为大家编辑器配置不一样而导致格式化后的代码风格不统一的问题。</p> <h3 id="集成-eslint-配置"><a href="#集成-eslint-配置" class="header-anchor">#</a> 集成 ESLint 配置</h3> <p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Feslint%2Feslint" title="https://github.com/eslint/eslint" target="_blank" rel="noopener noreferrer">ESLint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是一款用于查找并报告代码中问题的工具，并且支持部分问题自动修复。其核心是通过对代码解析得到的 AST（Abstract Syntax Tree 抽象语法树）进行模式匹配，来分析代码达到检查代码质量和风格问题的能力。</p> <p>正如前面我们提到的因团队成员之间编程能力和编码习惯不同所造成的代码质量问题，我们使用 ESLint 来解决，一边写代码一边查找问题，如果发现错误，就给出规则提示，并且自动修复，长期下去，可以促使团队成员往同一种编码风格靠拢。</p> <ol><li><p>安装 ESLint</p> <p>可以全局或者本地安装，作者推荐本地安装（只在当前项目中安装）。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i eslint -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>配置 ESLint</p> <p>ESLint 安装成功后，执行 <code>npx eslint --init</code>，然后按照终端操作提示完成一系列设置来创建配置文件。</p> <ul><li><p>How would you like to use ESLint? （你想如何使用 ESLint?）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c1424c45d06d4900807b3e0435911f4e~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>To check syntax, find problems, and enforce code style（检查语法、发现问题并强制执行代码风格）</strong></p></li> <li><p>What type of modules does your project use?（你的项目使用哪种类型的模块?）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/26e9ec1fd2934265847b0dabe908e6be~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>JavaScript modules (import/export)</strong></p></li> <li><p>Which framework does your project use? （你的项目使用哪种框架?）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/412df4bebb2c43b2858d5093652cc8ca~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>Vue.js</strong></p></li> <li><p>Does your project use TypeScript?（你的项目是否使用 TypeScript？）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee8aa15a0de84f2d9f16402f6870b3cd~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>Yes</strong></p></li> <li><p>Where does your code run?（你的代码在哪里运行?）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c86eb167b09a414dabb7ec3edb70a377~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>Browser 和 Node</strong>（按空格键进行选择，选完按回车键确定）</p></li> <li><p>How would you like to define a style for your project?（你想怎样为你的项目定义风格？）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f8beb21b44a14dbba7e0b9153d1f6a03~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>Use a popular style guide（使用一种流行的风格指南）</strong></p></li> <li><p>Which style guide do you want to follow?（你想遵循哪一种风格指南?）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/596c3755247a45a990d8c847d76fdad1~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>Airbnb: <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fairbnb%2Fjavascript" title="https://github.com/airbnb/javascript" target="_blank" rel="noopener noreferrer">github.com/airbnb/java…<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong></p> <p>ESLint 为我们列出了三种社区流行的 JavaScript 风格指南，分别是 Airbnb、Standard、Google。</p> <p>这三份风格指南都是由众多大佬根据多年开发经验编写，足够优秀，全球很多大小公司都在使用。我们选用 <strong>GitHub 上 star 最多的 Airbnb</strong>，免去繁琐的配置 ESLint 规则时间，然后让团队成员去学习 Airbnb JavaScript 风格指南即可。</p> <p>此时，我们在 ESLint 配置了 Airbnb JavaScript 规则，在编码时，所有不符合 Airbnb 风格的代码，编辑器都会给出提示，并且可以自动修复。</p> <p><strong>这里作者不建议大家去自由配置 ESLint 规则，相信我，这三份 JavaScript 代码风格指南值得我们反复学习，掌握后，编程能力能上一大台阶。</strong></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5b2e1d4a8c794d47866c6836d3a9e5fb~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <ul><li><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fstandard%2Fstandard" title="https://github.com/standard/standard" target="_blank" rel="noopener noreferrer">JavaScript Standard Style<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4faa4e26ff56491da56b240905f7ef16~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgoogle.github.io%2Fstyleguide%2Fjsguide.html" title="https://google.github.io/styleguide/jsguide.html" target="_blank" rel="noopener noreferrer">Google JavaScript Style Guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul></li> <li><p>What format do you want your config file to be in?（你希望你的配置文件是什么格式?）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6217a3458af34010bd8a3a55a0c03629~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>我们这里选择 <strong>JavaScript</strong></p></li> <li><p>Would you like to install them now with npm?（你想现在就用 NPM 安装它们吗?）</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6b1be913778348d1a59c2d7ea4c27a0c~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>根据上面的选择，ESLint 会自动去查找缺失的依赖，我们这里选择 <strong>Yes</strong>，使用 NPM 下载安装这些依赖包。</p> <p>注意：如果自动安装依赖失败，那么需要手动安装</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint-config-airbnb-base eslint-plugin-import eslint-plugin-vue -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul></li> <li><p>ESLint 配置文件 <code>.eslintrc.js</code></p> <p>在<strong>上一步</strong>操作完成后，会在项目根目录下自动生成 <code>.eslintrc.js</code> 配置文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  env<span class="token operator">:</span> <span class="token punctuation">{</span>
    browser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    es2021<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    node<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'plugin:vue/essential'</span><span class="token punctuation">,</span> <span class="token string">'airbnb-base'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  parserOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    ecmaVersion<span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    parser<span class="token operator">:</span> <span class="token string">'@typescript-eslint/parser'</span><span class="token punctuation">,</span>
    sourceType<span class="token operator">:</span> <span class="token string">'module'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'@typescript-eslint'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>根据项目实际情况，如果我们有额外的 ESLint 规则，也在此文件中追加。</p></li></ol> <p>注意：</p> <ul><li><p>VSCode 使用 ESLint 配置文件需要去插件市场下载插件 <strong>ESLint</strong> 。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/61a7c36554da4b8ab889f8bfde0538cc~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>JetBrains 系列（WebStorm、IntelliJ IDEA 等）则不用额外安装插件。</p></li></ul> <p>配置好以后，我们在 VSCode 或 WebStorm 等编辑器中开启 ESLin，写代码时，ESLint 就会按照我们配置的规则来进行实时代码检查，发现问题会给出对应错误提示和修复方案。</p> <p>如图：</p> <ul><li><p>VSCode <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a9b5cd64eed42a6ad60d1765809cac8~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>WebStorm <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e6b2c6dbd4a4020bc1abf418455178b~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul> <p>虽然，现在编辑器已经给出错误提示和修复方案，但需要我们一个一个去点击修复，还是挺麻烦的。很简单，我们只需设置编辑器保存文件时自动执行 <code>eslint --fix</code> 命令进行代码风格修复。</p> <ul><li><p>VSCode 在 <code>settings.json</code> 设置文件中，增加以下代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token string">&quot;editor.codeActionsOnSave&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;source.fixAll.eslint&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
 <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>WebStorm 打开设置窗口，按如下操作，最后点击 <code>Apply</code> -&gt; <code>OK</code>。 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/70659584632d432aa8c8cb8f6268b237~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul> <h3 id="解决-prettier-和-eslint-的冲突"><a href="#解决-prettier-和-eslint-的冲突" class="header-anchor">#</a> 解决 Prettier 和 ESLint 的冲突</h3> <p>通常大家会在项目中根据实际情况添加一些额外的 ESLint 和 Prettier 配置规则，难免会存在规则冲突情况。</p> <p>本项目中的 ESLint 配置中使用了 Airbnb JavaScript 风格指南校验，其规则之一是_代码结束后面要加分号_，而我们在 Prettier 配置文件中加了_代码结束后面不加分号_的配置项，这样就有冲突了，会出现用 Prettier 格式化后的代码，ESLint 检测到格式有问题的，从而抛出错误提示。</p> <p>解决两者冲突问题，需要用到 <strong>eslint-plugin-prettier</strong> 和 <strong>eslint-config-prettier</strong>。</p> <ul><li><p><code>eslint-plugin-prettier</code> 将 Prettier 的规则设置到 ESLint 的规则中。</p></li> <li><p><code>eslint-config-prettier</code> 关闭 ESLint 中与 Prettier 中会发生冲突的规则。</p></li></ul> <p>最后形成优先级：<code>Prettier 配置规则</code> &gt; <code>ESLint 配置规则</code>。</p> <ul><li><p>安装插件</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i eslint-plugin-prettier eslint-config-prettier -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>在 <code>.eslintrc.js</code> 添加 prettier 插件</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'plugin:vue/essential'</span><span class="token punctuation">,</span>
    <span class="token string">'airbnb-base'</span><span class="token punctuation">,</span>
    <span class="token string">'plugin:prettier/recommended'</span> <span class="token comment">// 添加 prettier 插件</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li></ul> <p>这样，我们在执行 <code>eslint --fix</code> 命令时，ESLint 就会按照 Prettier 的配置规则来格式化代码，轻松解决二者冲突问题。</p> <h3 id="集成-husky-和-lint-staged"><a href="#集成-husky-和-lint-staged" class="header-anchor">#</a> 集成 husky 和 lint-staged</h3> <p>我们在项目中已集成 ESLint 和 Prettier，在编码时，这些工具可以对我们写的代码进行实时校验，在一定程度上能有效规范我们写的代码，但团队可能会有些人觉得这些条条框框的限制很麻烦，选择视“提示”而不见，依旧按自己的一套风格来写代码，或者干脆禁用掉这些工具，开发完成就直接把代码提交到了仓库，日积月累，ESLint 也就形同虚设。</p> <p>所以，我们还需要做一些限制，让没通过 ESLint 检测和修复的代码禁止提交，从而保证仓库代码都是符合规范的。</p> <p>为了解决这个问题，我们需要用到 Git Hook，在本地执行 <code>git commit</code> 的时候，就对所提交的代码进行 ESLint 检测和修复（即执行 <code>eslint --fix</code>），如果这些代码没通过 ESLint 规则校验，则禁止提交。</p> <p>实现这一功能，我们借助 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ftypicode%2Fhusky" title="https://github.com/typicode/husky" target="_blank" rel="noopener noreferrer">husky<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> + <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fokonet%2Flint-staged" title="https://github.com/okonet/lint-staged" target="_blank" rel="noopener noreferrer">lint-staged<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 。</p> <blockquote><p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ftypicode%2Fhusky" title="https://github.com/typicode/husky" target="_blank" rel="noopener noreferrer">husky<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> —— Git Hook 工具，可以设置在 git 各个阶段（<code>pre-commit</code>、<code>commit-msg</code>、<code>pre-push</code> 等）触发我们的命令。<br> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fokonet%2Flint-staged" title="https://github.com/okonet/lint-staged" target="_blank" rel="noopener noreferrer">lint-staged<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> —— 在 git 暂存的文件上运行 linters。</p></blockquote> <h4 id="配置-husky"><a href="#配置-husky" class="header-anchor">#</a> 配置 husky</h4> <ul><li><p>自动配置（推荐）</p> <p>使用 <code>husky-init</code> 命令快速在项目初始化一个 husky 配置。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>npx husky-init <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> <span class="token function">install</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这行命令做了四件事：</p> <ol><li><p>安装 husky 到开发依赖 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/53b54bb5faed46e8ab15bb87be709f03~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>在项目根目录下创建 <code>.husky</code> 目录 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79b7c15af1474e0780110eec19d61ef4~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>在 <code>.husky</code> 目录创建 <code>pre-commit</code> hook，并初始化 <code>pre-commit</code> 命令为 <code>npm test</code> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/41617237db044ffab673d030078fc9b8~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>修改 <code>package.json</code> 的 <code>scripts</code>，增加 <code>&quot;prepare&quot;: &quot;husky install&quot;</code> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a8e3095a8b9471b8b6995055dd9ca2d~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ol></li> <li><p>手动配置（不推荐，懒是程序员第一生产力）</p> <ol><li><p>安装 husky</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i husky -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>创建 Git hooks</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>npx husky <span class="token function">install</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>该命令做了两件事：</p> <ul><li><p>在项目根目录下创建 <code>.husky</code> 目录 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ca444f89d984e66985fbc039599a218~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>在 <code>.husky</code> 目录创建 <code>pre-commit</code> hook，并初始化 <code>pre-commit</code> 命令为 <code>npm test</code> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d0e681125c94d1fac9016ccfae07146~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul></li> <li><p>手动修改 <code>package.json</code> 的 <code>scripts</code>，增加 <code>&quot;prepare&quot;: &quot;husky install&quot;</code> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68a982b547d74fabaed923ab8dc9f585~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ol></li></ul> <blockquote><p><strong>特别注意：本项目使用 husky 6.x 版本，6.x 版本配置方式跟之前的版本有较大差异。目前网上大部分有关 husky 的教程都是 6 以前的版本 ，跟本文教程不太一样，当发现配置方法不一致时，一切以 <a href="https://link.juejin.cn/?target=https%3A%2F%2Ftypicode.github.io%2Fhusky%2F%23%2F%3Fid%3Dusage" title="https://typicode.github.io/husky/#/?id=usage" target="_blank" rel="noopener noreferrer">husky 官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>为准。</strong></p></blockquote> <p>到这里，husky 配置完毕，现在我们来使用它：</p> <p>husky 包含很多 <code>hook</code>（钩子），常用有：<code>pre-commit</code>、<code>commit-msg</code>、<code>pre-push</code>。这里，我们使用 <code>pre-commit</code> 来触发 ESLint 命令。</p> <p>修改 <code>.husky/pre-commit</code> hook 文件的触发命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>eslint --fix ./src --ext .vue,.js,.ts

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/62fab24907ed473894d4624047506386~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>上面这个 <code>pre-commit</code> hook 文件的作用是：当我们执行 <code>git commit -m &quot;xxx&quot;</code> 时，会先对 <code>src</code> 目录下所有的 <code>.vue</code>、<code>.js</code>、<code>.ts</code> 文件执行 <code>eslint --fix</code> 命令，如果 ESLint 通过，成功 <code>commit</code>，否则终止 <code>commit</code>。</p> <p>但是又存在一个问题：有时候我们明明只改动了一两个文件，却要对所有的文件执行 <code>eslint --fix</code>。假如这是一个历史项目，我们在中途配置了 ESLint 规则，那么在提交代码时，也会对其他未修改的“历史”文件都进行检查，可能会造成大量文件出现 ESLint 错误，显然不是我们想要的结果。</p> <p>我们要做到只用 ESLint 修复自己此次写的代码，而不去影响其他的代码。所以我们还需借助一个神奇的工具 <strong>lint-staged</strong> 。</p> <h4 id="配置-lint-staged"><a href="#配置-lint-staged" class="header-anchor">#</a> 配置 lint-staged</h4> <p>lint-staged 这个工具一般结合 husky 来使用，它可以让 husky 的 <code>hook</code> 触发的命令只作用于 <code>git add</code>那些文件（即 git 暂存区的文件），而不会影响到其他文件。</p> <p>接下来，我们使用 lint-staged 继续优化项目。</p> <ol><li><p>安装 lint-staged</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i lint-staged -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>在 <code>package.json</code>里增加 lint-staged 配置项</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/34f5b846e6e7429aa111e173b12ef30e~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;*.{vue,js,ts}&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint --fix&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这行命令表示：只对 git 暂存区的 <code>.vue</code>、<code>.js</code>、<code>.ts</code> 文件执行 <code>eslint --fix</code>。</p></li> <li><p>修改 <code>.husky/pre-commit</code> hook 的触发命令为：<code>npx lint-staged</code></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f888eaf311614d0ba93bbe3744438b11~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ol> <p>至此，husky 和 lint-staged 组合配置完成。</p> <p>现在我们提交代码时就会变成这样：</p> <p>假如我们修改了 <code>scr</code> 目录下的 <code>test-1.js</code>、<code>test-2.ts</code> 和 <code>test-3.md</code> 文件，然后 <code>git add ./src/</code>，最后 <code>git commit -m &quot;test...&quot;</code>，这时候就会只对 <code>test-1.js</code>、<code>test-2.ts</code> 这两个文件执行 <code>eslint --fix</code>。如果 ESLint 通过，成功提交，否则终止提交。从而保证了我们提交到 Git 仓库的代码都是规范的。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3713b6409e4843b09344e65db19ddef3~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <ul><li><p>提交前 <code>test-1.js</code>、<code>test-2.ts</code> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8fae6d1caa6e44e1ad59af7b3af35705~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>提交后 <code>test-1.js</code>、<code>test-2.ts</code> 自动修复代码格式 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c54b19879578467082ac3668964fa612~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul> <p>无论写代码还是做其他事情，都应该用长远的眼光来看，刚开始使用 ESint 的时候可能会有很多问题，改起来也很费时费力，只要坚持下去，代码质量和开发效率都会得到提升，前期的付出都是值得的。</p> <p>这些工具并不是必须的，没有它们你同样可以可以完成功能开发，但是利用好这些工具，你可以写出更高质量的代码。特别是一些刚刚接触的人，可能会觉得麻烦而放弃使用这些工具，失去了一次提升编程能力的好机会。</p> <blockquote><p>本项目完整的代码托管在 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FXPoet%2Fvite-vue3-starter" title="https://github.com/XPoet/vite-vue3-starter" target="_blank" rel="noopener noreferrer">GitHub 仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，有需要的同学可以去下载下来，参考学习。<br> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FXPoet%2Fvite-vue3-starter" title="https://github.com/XPoet/vite-vue3-starter" target="_blank" rel="noopener noreferrer">点亮小星星 🌟 支持作者~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="提交规范"><a href="#提交规范" class="header-anchor">#</a> 提交规范</h2> <p>前面我们已经统一代码规范，并且在提交代码时进行强约束来保证仓库代码质量。多人协作的项目中，在提交代码这个环节，也存在一种情况：不能保证每个人对提交信息的准确描述，因此会出现提交信息紊乱、风格不一致的情况。</p> <p>如果 <code>git commit</code> 的描述信息精准，在后期维护和 Bug 处理时会变得有据可查，项目开发周期内还可以根据规范的提交信息快速生成开发日志，从而方便我们追踪项目和把控进度。</p> <p>这里，我们使用社区最流行、最知名、最受认可的 Angular 团队提交规范。</p> <p>先看看 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fangular%2Fangular%2Fcommits%2Fmaster" title="https://github.com/angular/angular/commits/master" target="_blank" rel="noopener noreferrer">Angular 项目的提交记录<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/64b5886214db4faba7250ca3b4c86638~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>如上图，可以看出这些提交信息都是有固定格式的，下面我们来学习 Angular 规范的 commit message 格式。</p> <h3 id="commit-message-格式规范"><a href="#commit-message-格式规范" class="header-anchor">#</a> commit message 格式规范</h3> <p>commit message 由 Header、Body、Footer 组成。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;Header&gt;

&lt;Body&gt;

&lt;Footer&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="header"><a href="#header" class="header-anchor">#</a> Header</h4> <p>Header 部分包括三个字段 type（必需）、scope（可选）和 subject（必需）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="type"><a href="#type" class="header-anchor">#</a> type</h5> <p>type 用于说明 commit 的提交类型（必须是以下几种之一）。</p> <p>值</p> <p>描述</p> <p>feat</p> <p>新增一个功能</p> <p>fix</p> <p>修复一个 Bug</p> <p>docs</p> <p>文档变更</p> <p>style</p> <p>代码格式（不影响功能，例如空格、分号等格式修正）</p> <p>refactor</p> <p>代码重构</p> <p>perf</p> <p>改善性能</p> <p>test</p> <p>测试</p> <p>build</p> <p>变更项目构建或外部依赖（例如 scopes: webpack、gulp、npm 等）</p> <p>ci</p> <p>更改持续集成软件的配置文件和 package 中的 scripts 命令，例如 scopes: Travis, Circle 等</p> <p>chore</p> <p>变更构建流程或辅助工具</p> <p>revert</p> <p>代码回退</p> <h5 id="scope"><a href="#scope" class="header-anchor">#</a> scope</h5> <p>scope 用于指定本次 commit 影响的范围。scope 依据项目而定，例如在业务项目中可以依据菜单或者功能模块划分，如果是组件库开发，则可以依据组件划分。（scope 可省略）</p> <h5 id="subject"><a href="#subject" class="header-anchor">#</a> subject</h5> <p>subject 是本次 commit 的简洁描述，长度约定在 50 个字符以内，通常遵循以下几个规范：</p> <ul><li>用动词开头，第一人称现在时表述，例如：change 代替 changed 或 changes</li> <li>第一个字母小写</li> <li>结尾不加句号（.）</li></ul> <h4 id="body"><a href="#body" class="header-anchor">#</a> Body</h4> <p>body 是对本次 commit 的详细描述，可以分成多行。（body 可省略）</p> <p>跟 subject 类似，用动词开头，body 应该说明修改的原因和更改前后的行为对比。</p> <h4 id="footer"><a href="#footer" class="header-anchor">#</a> Footer</h4> <p>如果本次提交的代码是突破性的变更或关闭缺陷，则 Footer 必需，否则可以省略。</p> <ul><li><p>突破性的变更</p> <p>当前代码与上一个版本有突破性改变，则 Footer 以 BREAKING CHANGE 开头，后面是对变动的描述、以及变动的理由。</p></li> <li><p>关闭缺陷</p> <p>如果当前提交是针对特定的 issue，那么可以在 Footer 部分填写需要关闭的单个 issue 或一系列 issues。</p></li></ul> <h4 id="参考例子"><a href="#参考例子" class="header-anchor">#</a> 参考例子</h4> <ul><li><p>feat</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>feat(browser): onUrlChange event (popstate/hashchange/polling)

Added new event to browser:
- forward popstate event if available
- forward hashchange event if popstate not available
- do polling when neither popstate nor hashchange available

Breaks $browser.onHashChange, which was removed (use onUrlChange instead)

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>fix</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>fix(compile): couple of unit tests for IE9

Older IEs serialize html uppercased, but IE9 does not...
Would be better to expect case insensitive, unfortunately jasmine does
not allow to user regexps for throw expectations.

Closes #392
Breaks foo.bar api, foo.baz should be used instead

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>style</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>style(location): add couple of missing semi colons

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>chore</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chore(release): v3.4.2

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h4 id="规范-commit-message-的好处"><a href="#规范-commit-message-的好处" class="header-anchor">#</a> 规范 commit message 的好处</h4> <ul><li>首行就是简洁实用的关键信息，方便在 git history 中快速浏览。</li> <li>具有更加详细的 body 和 footer，可以清晰的看出某次提交的目的和影响。</li> <li>可以通过 type 过滤出想要查找的信息，也可以通过关键字快速查找相关提交。</li> <li>可以直接从 commit 生成 change log。</li></ul> <h3 id="集成-commitizen-实现规范提交"><a href="#集成-commitizen-实现规范提交" class="header-anchor">#</a> 集成 Commitizen 实现规范提交</h3> <p>上面介绍了 Angular 规范提交的格式，初次接触的同学咋一看可能会觉得复杂，其实不然，如果让大家在 <code>git commit</code> 的时候严格按照上面的格式来写，肯定是有压力的，首先得记住不同的类型到底是用来定义什么，subject 怎么写，body 怎么写，footer 要不要写等等问题，懒才是程序员第一生产力，为此我们使用 Commitizen 工具来帮助我们自动生成 commit message 格式，从而实现规范提交。</p> <blockquote><p>Commitizen 是一个帮助撰写规范 commit message 的工具。它有一个命令行工具 cz-cli。</p></blockquote> <h4 id="安装-commitizen"><a href="#安装-commitizen" class="header-anchor">#</a> 安装 Commitizen</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install commitizen -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="初始化项目"><a href="#初始化项目" class="header-anchor">#</a> 初始化项目</h4> <p>成功安装 Commitizen 后，我们用 <strong>cz-conventional-changelog</strong> 适配器来初始化项目：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npx commitizen init cz-conventional-changelog --save-dev --save-exact

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这行命令做了两件事：</p> <ul><li><p>安装 cz-conventional-changelog 到开发依赖（devDependencies）</p></li> <li><p>在 <code>package.json</code> 中增加了 <code>config.commitizen</code></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&quot;config&quot;: {
  &quot;commitizen&quot;: {
    &quot;path&quot;: &quot;./node_modules/cz-conventional-changelog&quot;
  }
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/41d7516e310144fa9ab3d28b27d1b250~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul> <h4 id="使用-commitizen"><a href="#使用-commitizen" class="header-anchor">#</a> 使用 Commitizen</h4> <p>以前我们提交代码都是 <code>git commit -m &quot;xxx&quot;</code>，现在改为 <code>git cz</code>，然后按照终端操作提示，逐步填入信息，就能自动生成规范的 commit message。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d5bc364437b54bad9946fd43daaf10e7~tplv-k3u1fbpfcp-zoom-1.image" alt="image"> <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39d3441db8f54398b8344c803ef1325e~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>最后，在 Git 提交历史中就能看到刚刚规范的提交记录了： <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/137e940343d64d5588214015fea9f295~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <h4 id="自定义配置提交说明"><a href="#自定义配置提交说明" class="header-anchor">#</a> 自定义配置提交说明</h4> <p>从上面的截图可以看到，<code>git cz</code> 终端操作提示都是英文的，如果想改成中文的或者自定义这些配置选项，我们使用 <strong>cz-customizable</strong> 适配器。</p> <h5 id="cz-customizable-初始化项目"><a href="#cz-customizable-初始化项目" class="header-anchor">#</a> cz-customizable 初始化项目</h5> <p>运行如下命令使用 cz-customizable 初始化项目，注意之前已经初始化过一次，这次再初始化，需要加 <code>--force</code> 覆盖。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npx commitizen init cz-customizable --save-dev --save-exact --force

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这行命令做了两件事：</p> <ul><li><p>安装 cz-customizable 到开发依赖（devDependencies）</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  ...
  <span class="token property">&quot;cz-customizable&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^6.3.0&quot;</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span><span class="token punctuation">,</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>修改 <code>package.json</code> 中的 <code>config.commitizen</code> 字段为：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules/cz-customizable&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul> <h5 id="使用-cz-customizable"><a href="#使用-cz-customizable" class="header-anchor">#</a> 使用 cz-customizable</h5> <p>在项目根目录下创建 <code>.cz-config.js</code> 文件，然后按照官方提供的<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fleoforfree%2Fcz-customizable%2Fblob%2Fmaster%2Fcz-config-EXAMPLE.js" title="https://github.com/leoforfree/cz-customizable/blob/master/cz-config-EXAMPLE.js" target="_blank" rel="noopener noreferrer">示例<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>来配置。</p> <p>在本项目中我们修改成中文：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// type 类型（定义之后，可通过上下键选择）</span>
  types<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'feat'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'feat:     新增功能'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'fix'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'fix:      修复 bug'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'docs'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'docs:     文档变更'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'style'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'style:    代码格式（不影响功能，例如空格、分号等格式修正）'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'refactor'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'refactor: 代码重构（不包括 bug 修复、功能新增）'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'perf'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'perf:     性能优化'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'test:     添加、修改测试用例'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'build'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'build:    构建流程、外部依赖变更（如升级 npm 包、修改 webpack 配置等）'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'ci'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'ci:       修改 CI 配置、脚本'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'chore'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'chore:    对构建过程或辅助工具和库的更改（不影响源文件、测试用例）'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> value<span class="token operator">:</span> <span class="token string">'revert'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'revert:   回滚 commit'</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// scope 类型（定义之后，可通过上下键选择）</span>
  scopes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'components'</span><span class="token punctuation">,</span> <span class="token string">'组件相关'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'hooks'</span><span class="token punctuation">,</span> <span class="token string">'hook 相关'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'utils'</span><span class="token punctuation">,</span> <span class="token string">'utils 相关'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'element-ui'</span><span class="token punctuation">,</span> <span class="token string">'对 element-ui 的调整'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'styles'</span><span class="token punctuation">,</span> <span class="token string">'样式相关'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'deps'</span><span class="token punctuation">,</span> <span class="token string">'项目依赖'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'auth'</span><span class="token punctuation">,</span> <span class="token string">'对 auth 修改'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token string">'other'</span><span class="token punctuation">,</span> <span class="token string">'其他修改'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 如果选择 custom，后面会让你再输入一个自定义的 scope。也可以不设置此项，把后面的 allowCustomScopes 设置为 true</span>
    <span class="token punctuation">[</span><span class="token string">'custom'</span><span class="token punctuation">,</span> <span class="token string">'以上都不是？我要自定义'</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>value<span class="token punctuation">,</span> description<span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token punctuation">.</span><span class="token function">padEnd</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> (</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>description<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

  <span class="token comment">// 是否允许自定义填写 scope，在 scope 选择的时候，会有 empty 和 custom 可以选择。</span>
  <span class="token comment">// allowCustomScopes: true,</span>

  <span class="token comment">// allowTicketNumber: false,</span>
  <span class="token comment">// isTicketNumberRequired: false,</span>
  <span class="token comment">// ticketNumberPrefix: 'TICKET-',</span>
  <span class="token comment">// ticketNumberRegExp: '\\d{1,5}',</span>


  <span class="token comment">// 针对每一个 type 去定义对应的 scopes，例如 fix</span>
  <span class="token comment">/*
  scopeOverrides: {
    fix: [
      { name: 'merge' },
      { name: 'style' },
      { name: 'e2eTest' },
      { name: 'unitTest' }
    ]
  },
  */</span>

  <span class="token comment">// 交互提示信息</span>
  messages<span class="token operator">:</span> <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'确保本次提交遵循 Angular 规范！\n选择你要提交的类型：'</span><span class="token punctuation">,</span>
    scope<span class="token operator">:</span> <span class="token string">'\n选择一个 scope（可选）：'</span><span class="token punctuation">,</span>
    <span class="token comment">// 选择 scope: custom 时会出下面的提示</span>
    customScope<span class="token operator">:</span> <span class="token string">'请输入自定义的 scope：'</span><span class="token punctuation">,</span>
    subject<span class="token operator">:</span> <span class="token string">'填写简短精炼的变更描述：\n'</span><span class="token punctuation">,</span>
    body<span class="token operator">:</span>
      <span class="token string">'填写更加详细的变更描述（可选）。使用 &quot;|&quot; 换行：\n'</span><span class="token punctuation">,</span>
    breaking<span class="token operator">:</span> <span class="token string">'列举非兼容性重大的变更（可选）：\n'</span><span class="token punctuation">,</span>
    footer<span class="token operator">:</span> <span class="token string">'列举出所有变更的 ISSUES CLOSED（可选）。 例如: #31, #34：\n'</span><span class="token punctuation">,</span>
    confirmCommit<span class="token operator">:</span> <span class="token string">'确认提交？'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 设置只有 type 选择了 feat 或 fix，才询问 breaking message</span>
  allowBreakingChanges<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'feat'</span><span class="token punctuation">,</span> <span class="token string">'fix'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token comment">// 跳过要询问的步骤</span>
  <span class="token comment">// skipQuestions: ['body', 'footer'],</span>

  <span class="token comment">// subject 限制长度</span>
  subjectLimit<span class="token operator">:</span> <span class="token number">100</span>
  breaklineChar<span class="token operator">:</span> <span class="token string">'|'</span><span class="token punctuation">,</span> <span class="token comment">// 支持 body 和 footer</span>
  <span class="token comment">// footerPrefix : 'ISSUES CLOSED:'</span>
  <span class="token comment">// askForBreakingChangeFirst : true,</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br></div></div><p>建议大家结合项目实际情况来自定义配置提交规则，例如很多时候我们不需要写长描述，公司内部的代码仓库也不需要管理 issue，那么可以把询问 body 和 footer 的步骤跳过（在 <code>.cz-config.js</code> 中修改成 <code>skipQuestions: ['body', 'footer']</code>）。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c52e04ef0cda442fbd6c5c58691f8751~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <h3 id="集成-commitlint-验证提交规范"><a href="#集成-commitlint-验证提交规范" class="header-anchor">#</a> 集成 commitlint 验证提交规范</h3> <p>在“代码规范”章节，我们已经讲到过，尽管制定了规范，但在多人协作的项目中，总有些人依旧我行我素，因此提交代码这个环节，我们也增加一个限制：<strong>只让符合 Angular 规范的 commit message 通过</strong>，我们借助 @commitlint/config-conventional 和 @commitlint/cli 来实现。</p> <h4 id="安装-commitlint"><a href="#安装-commitlint" class="header-anchor">#</a> 安装 commitlint</h4> <p>安装 @commitlint/config-conventional 和 @commitlint/cli</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i @commitlint/config-conventional @commitlint/cli -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="配置-commitlint"><a href="#配置-commitlint" class="header-anchor">#</a> 配置 commitlint</h4> <ul><li><p>创建 commitlint.config.js 文件 在项目根目录下创建 <code>commitlint.config.js</code> 文件，并填入以下内容：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>或直接使用快捷命令：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;module.exports = {extends: ['@commitlint/config-conventional']}&quot;</span> <span class="token operator">&gt;</span> commitlint.config.js

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>使用 husky 的 <code>commit-msg</code> hook 触发验证提交信息的命令<br>
我们使用 husky 命令在 <code>.husky</code> 目录下创建 <code>commit-msg</code> 文件，并在此执行 commit message 的验证命令。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>npx husky <span class="token function">add</span> .husky/commit-msg <span class="token string">&quot;npx --no-install commitlint --edit <span class="token variable">$1</span>&quot;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c7bd07fe6104f7599c1a17c9c2971bf~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul> <h4 id="commitlint-验证"><a href="#commitlint-验证" class="header-anchor">#</a> commitlint 验证</h4> <ul><li><p>不符合规范的提交信息<br>
如下图，提交信息 <code>test commitlint</code> 不符合规范，提交失败。 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dcce89c773b1424d88c915446be8d0eb~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>符合规范的提交信息<br>
如下图，提交信息 <code>test: commitlint test</code> 符合规范，成功提交到仓库。 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/190ba1b62d8d433faf3d221eb8fb5119~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul> <p>因为已在项目中集成 commitizen，建议大家用 <code>git cz</code> 来代替 <code>git commit</code> 提交代码，可以保证提交信息规范。</p> <blockquote><p>本项目完整的代码托管在 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FXPoet%2Fvite-vue3-starter" title="https://github.com/XPoet/vite-vue3-starter" target="_blank" rel="noopener noreferrer">GitHub 仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，同学可以去下载下来，参考学习。<br> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FXPoet%2Fvite-vue3-starter" title="https://github.com/XPoet/vite-vue3-starter" target="_blank" rel="noopener noreferrer">点亮小星星 🌟 支持作者~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="单元测试"><a href="#单元测试" class="header-anchor">#</a> 单元测试</h2> <p>单元测试是项目开发中一个非常重要的环节，完整的测试能为代码和业务提供质量保证，减少 Bug 的出现。</p> <p>本章节将带领大家在 Vite + Vue3 + TypeScript 的项目中集成单元测试工具。</p> <h3 id="安装核心依赖"><a href="#安装核心依赖" class="header-anchor">#</a> 安装核心依赖</h3> <p>我们使用 Vue 官方提供的 <strong>vue-test-utils</strong> 和社区流行的测试工具 <strong>jest</strong> 来进行 Vue 组件的单元测试。</p> <ul><li><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fvue-test-utils-next" title="https://github.com/vuejs/vue-test-utils-next" target="_blank" rel="noopener noreferrer">vue-test-utils<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong> The next iteration of Vue Test Utils. It targets Vue 3.</li> <li><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Fjest" title="https://github.com/facebook/jest" target="_blank" rel="noopener noreferrer">jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong> Delightful JavaScript Testing.</li> <li><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fvue-jest" title="https://github.com/vuejs/vue-jest" target="_blank" rel="noopener noreferrer">vue-jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong> Jest Vue transformer</li> <li><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fkulshekhar%2Fts-jest" title="https://github.com/kulshekhar/ts-jest" target="_blank" rel="noopener noreferrer">ts-jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></strong> A Jest transformer with source map support that lets you use Jest to test projects written in TypeScript.</li></ul> <p>安装这些工具为开发依赖（devDependencies）：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i @vue/test-utils@next jest vue-jest@next ts-jest -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="创建-jest-配置文件"><a href="#创建-jest-配置文件" class="header-anchor">#</a> 创建 jest 配置文件</h3> <p>在项目根目录下新建 <code>jest.config.js</code> 文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  moduleFileExtensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  preset<span class="token operator">:</span> <span class="token string">'ts-jest'</span><span class="token punctuation">,</span>
  testEnvironment<span class="token operator">:</span> <span class="token string">'jsdom'</span><span class="token punctuation">,</span>
  transform<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'^.+\\.vue$'</span><span class="token operator">:</span> <span class="token string">'vue-jest'</span><span class="token punctuation">,</span> <span class="token comment">// vue 文件用 vue-jest 转换</span>
    <span class="token string">'^.+\\.ts$'</span><span class="token operator">:</span> <span class="token string">'ts-jest'</span> <span class="token comment">// ts 文件用 ts-jest 转换</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 匹配 __tests__ 目录下的 .js/.ts 文件 或其他目录下的 xx.test.js/ts xx.spec.js/ts</span>
  testRegex<span class="token operator">:</span> <span class="token string">'(/__tests__/.*|(\\.|/)(test|spec))\\.(ts)$'</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="创建单元测试文件"><a href="#创建单元测试文件" class="header-anchor">#</a> 创建单元测试文件</h3> <p>在上面的 <code>jest.config.js</code> 文件中，我们配置只匹配 <code>__tests__</code> 目录下的任意 <code>.ts</code> 文件或其他目录下的 <code>xx.test.ts</code>/<code>xx.spec.ts</code> 文件进行单元测试。</p> <p>这里，我们在项目根目录下创建 <code>tests</code> 目录来存储单元测试文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>├── src/
└── tests/                           // 单元测试目录
    ├── Test.spec.ts                 // Test 组件测试

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>Test.vue</code></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test-container page-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>page-title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>Unit Test Page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>count is: {{ count }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>increment<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>increment<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

  <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'Vuex'</span><span class="token punctuation">,</span>
    <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> count <span class="token operator">=</span> ref<span class="token operator">&lt;</span>number<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        count<span class="token punctuation">.</span>value <span class="token operator">+=</span> <span class="token number">1</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> count<span class="token punctuation">,</span> increment <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ul><li><p><code>Test.spec.ts</code></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> mount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/test-utils'</span>
<span class="token keyword">import</span> Test <span class="token keyword">from</span> <span class="token string">'../src/views/Test.vue'</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">'Test.vue'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> wrapper <span class="token operator">=</span> <span class="token function">mount</span><span class="token punctuation">(</span>Test<span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">'Unit Test Page'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">'count is: 0'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> wrapper<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>wrapper<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">'count is: 1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li></ul> <h3 id="集成-types-jest"><a href="#集成-types-jest" class="header-anchor">#</a> 集成 @types/jest</h3> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dee7edd88c1944e08950df2b20150df0~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>如上图，我们使用 VSCode / WebStrom / IDEA 等编辑器时，在单元测试文件中，IDE 会提示某些方法不存在（如 <code>test</code>、<code>describe</code>、<code>it</code>、<code>expect</code>等），安装 @types/jest 即可解决。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm i @types/jest -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>TypeScript 的编译器也会提示 jest 的方法和类型找不到，我们还需把 @types/jest 添加根目录下的 <code>ts.config.json</code>（TypeScript 配置文件）中：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    ...
    <span class="token property">&quot;types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;vite/client&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jest&quot;</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="添加-eslint-plugin-jest"><a href="#添加-eslint-plugin-jest" class="header-anchor">#</a> 添加 eslint-plugin-jest</h3> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b9838e1be1144caabfffd21f51913ff1~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>因为我们在项目中集成了 ESLint，如上图很明显是没通过 ESLint 规则检验。因此，我们还需要在 ESLint 中增加 <strong>eslint-plugin-jest</strong> 插件来解除对 jest 的校验。</p> <ul><li><p>安装 eslint-plugin-jest</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> i eslint-plugin-jest -D

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>添加 eslint-plugin-jest 到 ESLint 配置文件 <code>.eslintrc.js</code> 中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token operator">...</span>
    <span class="token string">'plugin:jest/recommended'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <p>现在，我们的单元测试代码就不会有错误提示信息了 ؏؏☝ᖗ 乛 ◡ 乛 ᖘ☝؏؏</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6e2a42118fb74a6888ea115dac8e3020~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <h3 id="执行单元测试"><a href="#执行单元测试" class="header-anchor">#</a> 执行单元测试</h3> <p>在根目录下 <code>package.json</code> 文件的 <code>scripts</code> 中，添加一条单元测试命令： <code>&quot;test&quot;: &quot;jest&quot;</code>。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/66354199386b431088db0593f34b88e6~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>执行命令 <code>npm run test</code> 即可进行单元测试，jest 会根据 <code>jest.config.js</code> 配置文件去查找 <code>__tests__</code> 目录下的 <code>.ts</code> 文件或其他任意目录下的 <code>.spec.ts</code> 和 <code>.test.ts</code> 文件，然后执行单元测试方法。</p> <blockquote><p>你可以在 <code>jest.config.js</code> 配置文件中，自由配置单元测试文件的目录。</p></blockquote> <ul><li><p>单元测试全部通过时的终端显示信息 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/183f9884427848ab80a14591dfb932c7~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li> <li><p>单元测试未全部通过时的终端显示信息 <img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5da2c3c3fd114693801f2c5703d6e028~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p></li></ul> <p>当单元测试没有全部通过时，我们需要根据报错信息去优化对应组件的代码，进一步提高项目健壮性。但是写单元测试是件比较痛苦的事，我个人觉得也没必要全部组件都写单元测试，根据项目实际情况有针对性去写就行了。</p> <h3 id="单元测试约束"><a href="#单元测试约束" class="header-anchor">#</a> 单元测试约束</h3> <p>前面，我们使用 husky 在 Git 的 <code>pre-commit</code> 和 <code>commit-msg</code> 阶段分别约束代码风格规范和提交信息规范。这一步，我们在 <code>pre-push</code> 阶段进行单元测试，只有单元测试全部通过才让代码 <code>push</code> 到远端仓库，否则终止 <code>push</code>。</p> <p>使用 husky 命令在 <code>.husky</code> 目录下自动创建 <code>pre-push</code> hook 文件，并在此执行单元测试命令 <code>npm run test</code>。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npx husky add .husky/pre-push &quot;npm run test $1&quot;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/40b47b6460ac42288bf421cc23519bfc~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>现在，我们在 <code>git push</code> 时就能先进行单元测试了，只有单元测试全部通过，才能成功 <code>push</code>。</p> <blockquote><p>本项目完整的代码托管在 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FXPoet%2Fvite-vue3-starter" title="https://github.com/XPoet/vite-vue3-starter" target="_blank" rel="noopener noreferrer">GitHub 仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，同学可以去下载下来，参考学习。<br> <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FXPoet%2Fvite-vue3-starter" title="https://github.com/XPoet/vite-vue3-starter" target="_blank" rel="noopener noreferrer">点亮小星星 🌟 支持作者~<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="自动部署"><a href="#自动部署" class="header-anchor">#</a> 自动部署</h2> <p>到了这一步，我们已经在项目中集成<strong>代码规范约束</strong>、<strong>提交信息规范约束</strong>，<strong>单元测试约束</strong>，从而保证我们远端仓库（如 GitHub、GitLab、Gitee 仓库等）的代码都是高质量的。</p> <p>本项目是要搭建一套规范的前端工程化环境，为此我们使用 CI（Continuous Integration 持续集成）来完成项目最后的部署工作。</p> <p>常见的 CI 工具有 GitHub Actions、GitLab CI、Travis CI、Circle CI 等。</p> <p>这里，我们使用 GitHub Actions。</p> <h3 id="什么是-github-actions"><a href="#什么是-github-actions" class="header-anchor">#</a> 什么是 GitHub Actions</h3> <p>GitHub Actions 是 GitHub 的持续集成服务，持续集成由很多操作组成，比如抓取代码、运行测试、登录远程服务器、发布到第三方服务等等，GitHub 把这些操作称为 actions。</p> <h3 id="配置-github-actions"><a href="#配置-github-actions" class="header-anchor">#</a> 配置 GitHub Actions</h3> <h4 id="创建-github-仓库"><a href="#创建-github-仓库" class="header-anchor">#</a> 创建 GitHub 仓库</h4> <p>因为 GitHub Actions 只对 GitHub 仓库有效，所以我们<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fnew" title="https://github.com/new" target="_blank" rel="noopener noreferrer">创建 GitHub 仓库<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>来托管项目代码。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/32022ada6b614b7a814dc57eef2a8072~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>其中，我们用：</p> <ul><li><code>master</code> 分支存储项目源代码</li> <li><code>gh-pages</code> 分支存储打包后的静态文件</li></ul> <blockquote><p><code>gh-pages</code> 分支，是 GitHub Pages 服务的固定分支，可以通过 HTTP 的方式访问到这个分支的静态文件资源。</p></blockquote> <h4 id="创建-github-token"><a href="#创建-github-token" class="header-anchor">#</a> 创建 GitHub Token</h4> <p>创建一个有 <strong>repo</strong> 和 <strong>workflow</strong> 权限的 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fsettings%2Ftokens%2Fnew" title="https://github.com/settings/tokens/new" target="_blank" rel="noopener noreferrer">GitHub Token<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ed133b71fcf54b6e884c0945ab1bdea5~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p>注意：新生成的 Token 只会显示一次，保存起来，后面要用到。如有遗失，重新生成即可。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d36f24b2a4924d109b12b3300fcdac42~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <h4 id="在仓库中添加-secret"><a href="#在仓库中添加-secret" class="header-anchor">#</a> 在仓库中添加 secret</h4> <p>将上面新创建的 Token 添加到 GitHub 仓库的 <code>Secrets</code> 里，并将这个新增的 <code>secret</code> 命名为 <code>VUE3_DEPLOY</code> （名字无所谓，看你喜欢）。</p> <p>步骤：仓库 -&gt; <code>settings</code> -&gt; <code>Secrets</code> -&gt; <code>New repository secret</code>。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/927922363c62497eb01ce72e59155278~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <blockquote><p>新创建的 secret <code>VUE3_DEPLOY</code> 在 Actions 配置文件中要用到，两个地方需保持一致！</p></blockquote> <h4 id="创建-actions-配置文件"><a href="#创建-actions-配置文件" class="header-anchor">#</a> 创建 Actions 配置文件</h4> <ol><li>在项目根目录下创建 <code>.github</code> 目录。</li> <li>在 <code>.github</code> 目录下创建 <code>workflows</code> 目录。</li> <li>在 <code>workflows</code> 目录下创建 <code>deploy.yml</code> 文件。</li></ol> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cc47cbed18534ac5abdeb1ec2f0f9664~tplv-k3u1fbpfcp-zoom-1.image" alt="image"></p> <p><code>deploy.yml</code> 文件的内容：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> deploy

<span class="token key atrule">on</span><span class="token punctuation">:</span>
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branches</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>master<span class="token punctuation">]</span> <span class="token comment"># master 分支有 push 时触发</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Setup Node.js v14.x
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>node@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">node-version</span><span class="token punctuation">:</span> <span class="token string">'14.x'</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install <span class="token comment"># 安装依赖</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build
        <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build <span class="token comment"># 打包</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> peaceiris/actions<span class="token punctuation">-</span>gh<span class="token punctuation">-</span>pages@v3 <span class="token comment"># 使用部署到 GitHub pages 的 action</span>
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">publish_dir</span><span class="token punctuation">:</span> ./dist <span class="token comment"># 部署打包后的 dist 目录</span>
          <span class="token key atrule">github_token</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.VUE3_DEPLOY <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token comment"># secret 名</span>
          <span class="token key atrule">user_name</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.MY_USER_NAME <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">user_email</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.MY_USER_EMAIL <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">commit_message</span><span class="token punctuation">:</span> Update Vite2.x + Vue3.x + TypeScript Starter <span class="token comment"># 部署时的 git 提交信息，自由填写</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h3 id="自动部署触发原理"><a href="#自动部署触发原理" class="header-anchor">#</a> 自动部署触发原理</h3> <p>当有新提交的代码 <code>push</code> 到 GitHub 仓库时，就会触发 GitHub Actions，在 GitHub 服务器上执行 Action 配置文件里面的命令，例如：<strong>安装依赖</strong>、<strong>项目打包</strong>等，然后将打包好的静态文件部署到 GitHub Pages 上，最后，我们就能通过域名访问了。</p> <p>使用自动部署，我们只需专注于项目开发阶段，任何重复且枯燥的行为都交由程序去完成，懒才是程序员第一生产力。</p> <p>事实上，自动部署只是 GitHub Actions 功能的冰山一角，GitHub Actions 能做的事还很多很多，大家感兴趣的话自行查阅。</p> <h2 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h2> <p>本文从技术选项到架构搭建、从代码规范约束到提交信息规范约束，从单元测试到到自动部署，一步一步带领大家如何从一个最简单的前端项目骨架到规范的前端工程化环境，基本涵盖前端项目开发的整个流程，特别适合刚接触前端工程化的同学学习。</p> <p>因篇幅较长，所涉及技术点较多，难免会出现错误，希望大家多多指正，谢谢大家！</p> <hr></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-a008c6ba data-v-a008c6ba><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-a008c6ba><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-a008c6ba></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-a008c6ba></path></svg></div><div class="kanbanniang" data-v-ee8d62e6><div class="banniang-container" style="display:;" data-v-ee8d62e6><div class="messageBox" style="right:68px;bottom:190px;display:none;" data-v-ee8d62e6>
      欢迎来到 jun的个人空间
    </div> <div class="operation" style="right:90px;bottom:40px;display:;" data-v-ee8d62e6><i class="kbnfont kbn-ban-home ban-home" data-v-ee8d62e6></i> <i class="kbnfont kbn-ban-message message" data-v-ee8d62e6></i> <i class="kbnfont kbn-ban-close close" data-v-ee8d62e6></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-ee8d62e6><i class="kbnfont kbn-ban-info info" data-v-ee8d62e6></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:none;" data-v-ee8d62e6></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="position:fixed;left:0px;bottom:0px;opacity:0.9;z-index:99999;" data-v-ee8d62e6></canvas></div> <div class="showBanNiang" style="display:none;" data-v-ee8d62e6>
    看板娘
  </div></div><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/blog/assets/js/app.2e9aaf02.js" defer></script><script src="/blog/assets/js/3.df7e12f5.js" defer></script><script src="/blog/assets/js/1.71a2a4d1.js" defer></script><script src="/blog/assets/js/29.f03180e4.js" defer></script>
  </body>
</html>
